![Alt text](/img/network_img/ipv4.png)
- Network ID : 24 bit, Host ID : 8 bit
- 1111 1111 : Broad Cast일 수 있다.
- IP 주소 : Internet 프로토콜을 쓰는 Host에 대한 식별자

![Alt text](/img/network_img/packet.png)
- 단위 데이터
- 최대 크기 MTU : Header + Payload 대체적으로 1500bytes

### En/Decapsulation

![Alt text](/img/network_img/capsulation.png)
**Encapsulation ( 캡슐화 )**

1. **응용 계층(Application layer)**은 **메시지(Message)**를 **전송 계층(Transport layer)**로 전달한다.

2. **전송 계층**은 메시지에 **포트 번호(Port number)**를 헤더로 첨부하여 **세그먼트(Segement)**를 생성하고 이를 **네트워크 계층(Network layer)**로 전송한다.

3. **네트워크 계층**은 세그먼트에 **IP 주소**를 포함한 **데이터그램(Datagram)**을 생성하고 이를 **링크 계층(Link layer)**으로 보낸다.

4. **링크 계층**은 데이터그램에 **MAC 주소**를 포함한 **프레임(Frame)**를 생성하고 이를 **물리 계층(Physical layer)**으로 전달한다.

5. 프레임은 목적지의 물리 계층으로 전송되며, 도착한 곳에서 MAC 주소가 일치하는지 확인하고 프레임을 수신한다.

6. **디캡슐화(Decapsulation)**는 수신된 패킷이 위의 과정을 역순으로 거쳐 메시지를 원래의 형태로 복원하는 과정을 말한다.

**Decapsulation ( 역캡슐화 )**

1. **물리 계층(Physical layer)**에서는 수신된 **프레임(Frame)**의 목적지 MAC 주소와 자신의 MAC 주소를 비교하여 일치하면 프레임을 수신하고 이를 **링크 계층(Link layer)**로 전달한다.

2. **링크 계층**은 수신된 프레임에서 MAC 주소를 제거하여 **데이터그램(Datagram)**을 생성하고, 이를 **네트워크 계층(Network layer)**로 보낸다.

3. **네트워크 계층**은 데이터그램의 목적지 IP와 수신 IP를 비교하고, 일치하는 경우 IP를 제거한 **세그먼트(Segement)**를 **전송 계층(Transport layer)**로 전달한다.

4. **전송 계층**은 세그먼트의 포트 번호를 확인하고, 해당 포트 번호를 갖는 **응용 계층(Application layer)**의 적절한 서버로 세그먼트에서 포트 번호를 제거한 **메시지(Message)**를 보낸다.

5. **응용 계층**은 메시지를 수신하고 확인한다.

### 계층별 데이터 단위
- User mode : Socket, Stream
- TCP : Segment, Segmentation, MSS(1460bytes)
- IP : Packet, MTU(1500bytes)
- L1 ~ L2 : Frame

### Network 장애
1. **Lost Segment (유실)**: 네트워크를 통해 데이터를 전송하는 도중 세그먼트가 사라져 버리는 상황이다. 이는 네트워크 혼잡, 패킷 충돌 등 다양한 이유로 발생한다.

2. **Retransmission (재전송)**: 송신자가 세그먼트를 수신자에게 보냈지만, 어떤 이유로 수신자가 그것을 받지 못한 경우 발생한다. 이런 경우, 수신자는 송신자에게 해당 세그먼트의 재전송을 요청한다.

3. **Out of Order (순서가 다르게 수신)**: 데이터 세그먼트는 원래 순차적으로 전송되지만, 때때로 수신자는 이것들을 원래의 순서와 다르게 받는다. 이는 네트워크 혼잡이나 패킷의 경로 변경 등의 이유로 발생한다.

4. **Zero Window**: 이는 수신자가 더 이상 데이터를 받을 수 없는 상황을 의미한다. 소켓 I/O로 받을 수 있는 데이터의 양이 '윈도우 크기'인데, 이 크기가 0이 되면 수신자는 송신자가 보내는 데이터를 받을 수 없다. 이러한 상태는 주로 수신자의 애플리케이션에서 문제가 발생했을 때 나타난다.