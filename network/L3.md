![Alt text](/img/network_img/ipv4.png)
- Network ID : 24 bit, Host ID : 8 bit
- 1111 1111 : Broad Cast일 수 있다.
- IP 주소 : Internet 프로토콜을 쓰는 Host에 대한 식별자

![Alt text](/img/network_img/packet.png)
- 단위 데이터
- 최대 크기 MTU : Header + Payload 대체적으로 1500bytes

### En/Decapsulation

![Alt text](/img/network_img/capsulation.png)
**Encapsulation ( 캡슐화 )**

1. **응용 계층(Application layer)**은 **메시지(Message)**를 **전송 계층(Transport layer)**로 전달한다.

2. **전송 계층**은 메시지에 **포트 번호(Port number)**를 헤더로 첨부하여 **세그먼트(Segement)**를 생성하고 이를 **네트워크 계층(Network layer)**로 전송한다.

3. **네트워크 계층**은 세그먼트에 **IP 주소**를 포함한 **데이터그램(Datagram)**을 생성하고 이를 **링크 계층(Link layer)**으로 보낸다.

4. **링크 계층**은 데이터그램에 **MAC 주소**를 포함한 **프레임(Frame)**를 생성하고 이를 **물리 계층(Physical layer)**으로 전달한다.

5. 프레임은 목적지의 물리 계층으로 전송되며, 도착한 곳에서 MAC 주소가 일치하는지 확인하고 프레임을 수신한다.

6. **디캡슐화(Decapsulation)**는 수신된 패킷이 위의 과정을 역순으로 거쳐 메시지를 원래의 형태로 복원하는 과정을 말한다.

**Decapsulation ( 역캡슐화 )**

1. **물리 계층(Physical layer)**에서는 수신된 **프레임(Frame)**의 목적지 MAC 주소와 자신의 MAC 주소를 비교하여 일치하면 프레임을 수신하고 이를 **링크 계층(Link layer)**로 전달한다.

2. **링크 계층**은 수신된 프레임에서 MAC 주소를 제거하여 **데이터그램(Datagram)**을 생성하고, 이를 **네트워크 계층(Network layer)**로 보낸다.

3. **네트워크 계층**은 데이터그램의 목적지 IP와 수신 IP를 비교하고, 일치하는 경우 IP를 제거한 **세그먼트(Segement)**를 **전송 계층(Transport layer)**로 전달한다.

4. **전송 계층**은 세그먼트의 포트 번호를 확인하고, 해당 포트 번호를 갖는 **응용 계층(Application layer)**의 적절한 서버로 세그먼트에서 포트 번호를 제거한 **메시지(Message)**를 보낸다.

5. **응용 계층**은 메시지를 수신하고 확인한다.

### 계층별 데이터 단위
- User mode : Socket, Stream
- TCP : Segment, Segmentation, MSS(1460bytes)
- IP : Packet, MTU(1500bytes)
- L1 ~ L2 : Frame

### Network 장애
1.  **Lost Segment (유실)**
2.  **Retransmission (재전송)**
3.  **Out of order (순서가 다르게 수신 Network에서 문제가 발생)**
4.  **Zero window** : Socket I/O로 받을 수 있는 데이터 사이즈를 Window Size라고 하는데 이 Window Size가 0이 되면 송신자가 데이터를 보내도 수신을 할 수 없다. (End-Point의 Application에서 문제가 발생)